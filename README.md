 # Дипломный проект профессии «1C-программист: с нуля до middle»
 
## Кастомизация конфигурации «Управление IT-фирмой для компании «Ваш компьютерный мастер»

### Цель дипломного проекта

Разработать и подготовить к эксплуатации новый функциональный блок в конфигурации «Управление IT-фирмой».

Вам нужно:

- реализовать новые подсистемы «Работа с заявками клиентов» и «Расчёт управленческой зарплаты» в соответствии с требованиями заказчика,
- подготовить отчёты по новой функциональности,
- оформить инструкцию по начальной настройке,
- подготовить автотест для проверки корректности работы подсистемы «Работа с заявками клиентов»,
- загрузить результат работы в новый репозиторий на GitHub.

Полный текст задачи находится [ЗДЕСЬ](https://github.com/netology-code/fonecmid-diplom)
------
## Решение
------
## Работа с заявками клиентов

### Подсистема Обслуживание клиентов

#### Договоры на абонентское обслуживание

Добален новый вид договоров "Абонентское обслуживание" в справочнике Договоры контрагентов, с возможность внести дату начала действия договора, дату окончания действия договора, сумму ежемесячной абоненсткой платы и стоимость часа работы специалиста.

------
#### Документ Обслуживание клиентов

Процесс работы с заявками построен следующим образом:

1. Клиент звонит менеджеру и оставляет заявку на работу специалиста с указанием проблемы, для решения которой нужен специалист.
2. Менеджер ищет свободное время и планирует заявку на это время.
3. При планировании телеграм-бот оповещает специалистов о появлении новой заявки.
4. Специалист в назначенное время в офисе клиента или удалённо проводит необходимые работы.
5. Специалист получает подписанный лист учёта рабочего времени или скан/фото листа учёта от клиента. В листе учёта перечисляются виды работ, выполненные специалистом, и фиксируется количество часов к оплате. В дальнейшем документ будет являться подтверждением проведения работ.
6. Специалист вносит в информационную систему информацию о выполненных работах, количество фактически потраченных часов на каждый вид работы, количество часов к оплате клиенту за каждый вид работы и прикрепляет к документу скан/фото листа учёта рабочего времени.

С документом Обслуживание клиентов работают менеджеры и специалисты. Для работы с данным документом созданы предопределенные профили пользователей МенеджерПОК по обслуживанию и СпециалистПОК.

#### Документ Реализации товаров и услуг
Если в документе Реализация товаров и услуг выбран догоовр с видом абонентская плата, то при нажатии на кнопку "заполнить", автоматически заполняется сумма ежемесячной платы и сумма за выполненные в течении месяца услуги по данным документа Обслуживание клиентов.
Из документа печатается акт выполненных услуг.
С документом Реализации товаров и услуг бухгалтеры. Для работы с данным документом созданы предопределенный профиль пользователя Бухгалтер, соответсвующая роль к нему.

#### Массовое Создание документов Реализация товаров и услуг
Создана обработка Массовое создание актов, которая формирует акты по всем абонентским договорам за указанный период. Обработку использует бухгалтер, с предопределенным профилем пользователя Бухгалтер и соответсвующей ролью.


## Расчёт управленческой зарплаты

На предприятии работают сотрудники двух категорий: специалисты и административный персонал. Специалистам начисляется минимальный оклад и процент за выполненные работы клиентам. Административный персонал получает оклад. Любому сотруднику на усмотрение руководства может быть начислена разовая фиксированная премия. Сотрудники могут уходить в отпуск. В период отпуска оклад не начисляется. Отпускные рассчитываются из расчёта среднедневной заработной платы за последние 12 месяцев:

(Начисленная сумма за 12 мес. / Количество рабочих дней) х Количество календарных дней отпуска

С каждого сотрудника удерживается НДФЛ – 13%.

Для каждого сотрудника необходимо хранить суммы окладов. Дополнительно для специалистов необходимо хранить процент от выполненных заказов, который им будет начисляться. Расчёт зарплаты выполняется документом НачислениеЗаработнойПлаты по всем видам расчёта, кроме премий. Премии начисляются отдельным документом НачислениеФиксированныхПремий. В документах НачислениеЗаработнойПлаты и НачислениеФиксированныхПремий автоматически рассчитывается удержание НДФЛ.
Так же, для документа ОбслуживаниеКлиента дополнительно реализована проверка: если на дату првоедениия документа для специалиста не установлен процент оплаты от работа, то документ не будет проволиться, учтено, что процент может быть нулевым(документ проводится).

Планирование отпусков производится с помошью соответсвуещего документа. Для удобства выполнена подсветка строк сотрудников, чей отпуск превышает 28 дней. Данные вносятся в начале года.
Для контроля отпусков используется диаграмма Ганта, открывающаяяся по кнопке "Анализ графика".

С подсистемой работает кадровик-расчетчик, с профилем Кадровик-расчетчик, и соответсвующими праввами.


## Отчеты
#### Выработка специалистов
Отчет показывает, сколько часов за выбранный период отработал выбранный специалист и какая сумма ему за этот период начислена в виде процента от выплат клиента.
#### Анализ выставленных актов
Отчёт показывает информацию о клиентах, договорах и суммах, которые должны быть выставлены клиентам на основе данных из документов Обслуживание.
#### Расчеты с сотрудниками
В отчете псодержится информация о том, какие суммы начислены и выплачены каждому сотруднику за указанный период. Также в отчете отражена задолженность на начало и на конец этого периода.
#### Расход запланированных отпусков
Отчет показываает сколько дней отпуска у сотрудника в выбранный период по плану и сколько дней он фактически был в отпуске. Отчет строится за год.

#### Права доступа к отчетам
Отчёт по выработке специалистов доступен специалистам и кадровикам-расчетчикам.
Отчёт по анализу выставленных актов доступен бухгалтерам.
Отчёты по зарплате и отпускам доступы кадровикам-расчётчикам.

## Подсистема добавленные объекты
Данная подсистема доступна для просмотра пользователю с правами доступа "администратор", включает в себя все добавленные объекты в исходную базу.


## Инструкция по начальной настройке
При первом запуске необходимо создать новых пользователей:
       - Создать пользователя с правами доступа Администратор (Профиль пользователя Администратор)
       - Создать пользователей с правами доступа Бухгалтер, Кадровик-расчетчик, СпециалистПОК, МенеджерПОК по обслуживанию выбрав соответствующий профиль пользователя
#### Подсистема Обслуживание клиентов
1. В режиме администратора настроить [телеграмм-бота](https://github.com/netology-code/fonecmid-diplom/blob/main/tasks/telegram.md).
2. Настроить регламентное задание по отпревке сообщений в телеграмм-бот.
3. Из полученных данных настройки Телеграмм-бота заполнить Константы BKM_ТокенУправленияТБотом и BKM_ИдентификаторГруппыОповещения.
4. Создать номенклатуру (или выбрать существующую) с видом номенклатуры Услуги, которая будет отображаться в актах об оказании услуг клиенту. Рекомендуется Абонентская плата и Работы специалиста. Заполнить созданными (выбранными) наименованиями соответствующие константы: BKM_НоменклатураАбонентскаяПлата и BKM_НоменклатураРаботыСпециалиста.
###### Перед первым использованием подсистемы Обслуживание клиентов другими пользователями, пользователь с проыилем Кадровик-расчетчик должен:
1. Заполнить справочник Сотрудники данными о сотрудниках.
2. Заполнить регистр сведений Условия оплаты сотрудников(поле процент от работ). Необходимо учесть период, с которого устанавливется процент оплаты сотрудникам, он должен быть меньше, чем планируемые даты документов.

#### Подсистема Расчет заработной платы
1. Нужно заполнить справочник График работ. Для графика отпуск - предопределенная запись - Отпуск календарные дни.
2. С помощью обработки Заполнение графиков работ, заполните соответствующий график. В поле обработки Выходные дни указываются дни недели цифрами, которые являются выходными. Например для графика пятидневка поле заполняется значением "6,7".
3. Кадровик-расчетчик в обязательном порядке должен дополнить регистр сведения УсловияОплатыСотрудников поля о гафике работы сотрудника и окладу.
4. Кадровик-расчетчик должен в разделе сервис назначить график работ для отпуска (Должны учитываться все дни).


## Тестирование.
### Сценарии
1. Планирование нескольких обслуживаний на специалистов от имени Менеджера
2. Закрытие обслуживаний от имени Специалиста
3. Массовое создание актов от имени Бухгалтера
4. Формирование отчёта Анализ выставленных актов, сравнение с эталоном

### Автотесты реализованы с помощью Vanessa Automation.
1. Все автотесты запускаются на приложенной базе данных. В этой базе настроены предопределенные данные и заполнены справочники тестовыми данными.
2. Перед запуском автотеста клиент-тест должен быть закрыт.
3. Автотестирование должно проходить в строгой последовательности, так как некоторые тесты оприаются на данные созданными другими тестами.
   -   Первым идет запуск автотестирования из файла Тестирование МенеджерПОК.feature.
   -   Вторым - Тестирование СпециалистПОК.feature
   -   Третиьм - Тестирование Бухгалтер.feature
